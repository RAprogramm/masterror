Цели дизайна

Явные коды и домены
thiserror форматирует сообщение, но не даёт стабильных кодов. Введи:

ErrorCode(NonZeroU32) и ErrorDomain(&'static str).

Инвариант: код стабилен, сообщение и поля — нет.

Диапазоны кодов per-crate/перенейминг через макрос домена.

Прозрачный рантайм: ноль лишних аллокаций

Display строится без format! при конструировании.

Сообщение — &'static str + форматирование аргументов на выводе.

Опциональный Backtrace по фиче, захват один раз при создании.

Минимальный proc-macro

Зависимости только proc_macro2, syn, quote. Никаких reflection-трюков, никаких «скрытых» From на всё подряд.

Атрибуты валидируются жёстко, ошибки — диагностически понятные.

Интероп и миграция

From<anyhow::Error>/Into<anyhow::Error> по фиче.

Маппинг thiserror-стиля: #[source], #[transparent], форматные строки.

Утилиты: chain() итератор по причинам, report() для человекочитаемого трейсинга.

Контекст и структурные данные без глобального стейта

Лёгкий Context как иммутабельный key-value snapshot (SmallVec<[(&'static str, Cow<'static, str>); N]>), без мутабельного глобала.

По фиче serde — сериализация структурных данных.

MSRV/скорость компиляции

MSRV = актуальный LTS/твоя корпоративная, без «танцев» в макросе.

Меньше генерируемого кода: без дублирующих From/Display там, где можно обойтись общими трейтом-адаптерами.
